    f.write("---------------------\n")
    f.write('PCAP info:\n')
    f.write(f'Number of packets: {total_packets}\n')
    f.write(f'Total Source IPs: {len(ip_src)}\n')
    f.write(f'Other traffic: {other}')
    f.write("---------------------\n")
    f.write("---------------------\n")
    f.write("icmp\n")
    f.write(f'Total icmp flows: {len(icmp_flows.keys())}\n')
    f.write(f'icmp Uniqe IP src: {len(icmp_src)}\n')
    f.write("---------------------\n")
    f.write('icmp slow stats\n')
    f.write(f'Total icmp slow src ips: {sum(val["ip_src_count"] for val in icmp_dist_slow.values())}\n')
    f.write(f'Total icmp slow one-to-one src ips: {sum(val["ip_src_count"] for val in icmp_onetoone_slow.values())}\n')
    f.write(f'Total icmp slow one-to-many src ips: {sum(val["ip_src_count"] for val in icmp_onetomany_slow.values())}\n')
    f.write(f'Total icmp slow many-to-one src ips: {sum(val["ip_src_count"] for val in icmp_manytoone_slow.values())}\n')
    f.write(f'Total icmp slow many-to-many src ips: {sum(val["ip_src_count"] for val in icmp_manytomany_slow.values())}\n')
    f.write("---------------------\n")
    f.write('icmp medium stats\n')
    f.write(f'Total icmp medium src ips: {sum(val["ip_src_count"] for val in icmp_dist_medium.values())}\n')
    f.write(f'Total icmp medium one-to-one src ips: {sum(val["ip_src_count"] for val in icmp_onetoone_medium.values())}\n')
    f.write(f'Total icmp medium one-to-many src ips: {sum(val["ip_src_count"] for val in icmp_onetomany_medium.values())}\n')
    f.write(f'Total icmp medium many-to-one src ips: {sum(val["ip_src_count"] for val in icmp_manytoone_medium.values())}\n')
    f.write(f'Total icmp medium many-to-many src ips: {sum(val["ip_src_count"] for val in icmp_manytomany_medium.values())}\n')
    f.write("---------------------\n")
    f.write('icmp Rapid stats\n')
    f.write(f'Total icmp rapid src ips: {sum(val["ip_src_count"] for val in icmp_dist_rapid.values())}\n')
    f.write(f'Total icmp rapid one-to-one src ips: {sum(val["ip_src_count"] for val in icmp_onetoone_rapid.values())}\n')
    f.write(f'Total icmp rapid one-to-many src ips: {sum(val["ip_src_count"] for val in icmp_onetomany_rapid.values())}\n')
    f.write(f'Total icmp rapid many-to-one src ips: {sum(val["ip_src_count"] for val in icmp_manytoone_rapid.values())}\n')
    f.write(f'Total icmp rapid many-to-many src ips: {sum(val["ip_src_count"] for val in icmp_manytomany_rapid.values())}\n')
    f.write("---------------------\n")
    f.write("---------------------\n")
    f.write("---------------------\n")
    f.write("icmp\n")
    f.write(f'Total icmp flows: {len(icmp_flows.keys())}\n')
    f.write(f'icmp Uniqe IP src: {len(icmp_src)}\n')
    f.write("---------------------\n")
    f.write('icmp slow stats\n')
    f.write(f'Total icmp slow src ips: {sum(val["ip_src_count"] for val in icmp_dist_slow.values())}\n')
    f.write(f'Total icmp slow one-to-one src ips: {sum(val["ip_src_count"] for val in icmp_onetoone_slow.values())}\n')
    f.write(f'Total icmp slow one-to-many src ips: {sum(val["ip_src_count"] for val in icmp_onetomany_slow.values())}\n')
    f.write(f'Total icmp slow many-to-one src ips: {sum(val["ip_src_count"] for val in icmp_manytoone_slow.values())}\n')
    f.write(f'Total icmp slow many-to-many src ips: {sum(val["ip_src_count"] for val in icmp_manytomany_slow.values())}\n')
    f.write("---------------------\n")
    f.write('icmp Medium stats\n')
    f.write(f'Total icmp medium src ips: {sum(val["ip_src_count"] for val in icmp_dist_medium.values())}\n')
    f.write(f'Total icmp medium one-to-one src ips: {sum(val["ip_src_count"] for val in icmp_onetoone_medium.values())}\n')
    f.write(f'Total icmp medium one-to-many src ips: {sum(val["ip_src_count"] for val in icmp_onetomany_medium.values())}\n')
    f.write(f'Total icmp medium many-to-one src ips: {sum(val["ip_src_count"] for val in icmp_manytoone_medium.values())}\n')
    f.write(f'Total icmp medium many-to-many src ips: {sum(val["ip_src_count"] for val in icmp_manytomany_medium.values())}\n')
    f.write("---------------------\n")
    f.write('icmp Rapid stats+n')
    f.write(f'Total icmp rapid src ips: {sum(val["ip_src_count"] for val in icmp_dist_rapid.values())}\n')
    f.write(f'Total icmp rapid one-to-one src ips: {sum(val["ip_src_count"] for val in icmp_onetoone_rapid.values())}\n')
    f.write(f'Total icmp rapid one-to-many src ips: {sum(val["ip_src_count"] for val in icmp_onetomany_rapid.values())}\n')
    f.write(f'Total icmp rapid many-to-one src ips: {sum(val["ip_src_count"] for val in icmp_manytoone_rapid.values())}\n')
    f.write(f'Total icmp rapid many-to-many src ips: {sum(val["ip_src_count"] for val in icmp_manytomany_rapid.values())}\n')
    f.write("---------------------\n")
    f.write("---------------------\n")
    f.write("---------------------\n")
    f.write("ICMP+n")
    f.write(f'Total ICMP flows: {len(icmp_flows.keys())}\n')
    f.write(f'ICMP Uniqe IP src: {len(icmp_src)}\n')
    f.write("---------------------\n")
    f.write('ICMP slow stats+n')
    f.write(f'Total icmp slow src ips: {sum(val["ip_src_count"] for val in icmp_dist_slow.values())}\n')
    f.write(f'Total icmp slow one-to-one src ips: {sum(val["ip_src_count"] for val in icmp_onetoone_slow.values())}\n')
    f.write(f'Total icmp slow one-to-many src ips: {sum(val["ip_src_count"] for val in icmp_onetomany_slow.values())}\n')
    f.write(f'Total icmp slow many-to-one src ips: {sum(val["ip_src_count"] for val in icmp_manytoone_slow.values())}\n')
    f.write(f'Total icmp slow many-to-many src ips: {sum(val["ip_src_count"] for val in icmp_manytomany_slow.values())}\n')
    f.write("---------------------\n")
    f.write('ICMP Medium stats\n')
    f.write(f'Total icmp medium src ips: {sum(val["ip_src_count"] for val in icmp_dist_medium.values())}\n')
    f.write(f'Total icmp medium one-to-one src ips: {sum(val["ip_src_count"] for val in icmp_onetoone_medium.values())}\n')
    f.write(f'Total icmp medium one-to-many src ips: {sum(val["ip_src_count"] for val in icmp_onetomany_medium.values())}\n')
    f.write(f'Total icmp medium many-to-one src ips: {sum(val["ip_src_count"] for val in icmp_manytoone_medium.values())}\n')
    f.write(f'Total icmp medium many-to-many src ips: {sum(val["ip_src_count"] for val in icmp_manytomany_medium.values())}\n')
    f.write("---------------------\n")
    f.write('ICMP Rapid stats\n')
    f.write(f'Total icmp rapid src ips: {sum(val["ip_src_count"] for val in icmp_dist_rapid.values())}\n')
    f.write(f'Total icmp rapid one-to-one src ips: {sum(val["ip_src_count"] for val in icmp_onetoone_rapid.values())}\n')
    f.write(f'Total icmp rapid one-to-many src ips: {sum(val["ip_src_count"] for val in icmp_onetomany_rapid.values())}\n')
    f.write(f'Total icmp rapid many-to-one src ips: {sum(val["ip_src_count"] for val in icmp_manytoone_rapid.values())}\n')
    f.write(f'Total icmp rapid many-to-many src ips: {sum(val["ip_src_count"] for val in icmp_manytomany_rapid.values())}\n')
    f.write("---------------------\n")
    f.write(f'Other traffic: {other}\n')
    f.write("---------------------\n")


Unique_labled_sources_icmp = (len(unique_icmp_hport_scans) + len(unique_icmp_lport_scans) + 
                            len(unique_icmp_hnetwork_scans) + len(unique_icmp_lnetwork_scans) +
                            len(unique_icmp_one_flow) + len(unique_icmp_back) + 
                            len(unique_icmp_fragment) + len(unique_small_syns_final) + 
                            len(unique_other_icmp))